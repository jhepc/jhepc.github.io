<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
    <title>John Hunter Excellence Plotting Contest &#8212; 2015 Scipy John Hunter Excellence in Plotting Contest Entries 0.0001 documentation</title>
  <!-- htmltitle is before nature.css - we use this hack to load bootstrap first -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet"
        href="../../_static/css/bootstrap.min.css"
	media="screen" />
    <script src="../../_static/js/jquery.js"
          type="text/javascript"></script>
  <script src="../../_static/js/bootstrap.min.js"
          type="text/javascript"></script>


    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport'
      content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="stylesheet"
        href="../../_static/css/jhepc.css"
         media="screen" />
  <link href='http://fonts.googleapis.com/css?family=PT+Serif'
        rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=PT+Sans'
        rel='stylesheet' type='text/css'>



  </head><body><div class="navbar">
    <a class="navbar-brand" href="../../index.html">
      <img src="../../_static/logos/logo_1.png" \>
    </a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Home
          <img src="../../_static/logos/button_orange.png">
        </a>
        </li>
      <li><a href="../../gallery.html">Gallery
          <img src="../../_static/logos/button_blue.png">
          </a>
      </li>
      <li><a href="../../about.html">About
          <img src="../../_static/logos/button_green.png">
          </a></li>
    </ul>
  </div>
  
    <div class="container">
  
  
  <div class="section" id="entry-15">
<h1>Entry 15<a class="headerlink" href="#entry-15" title="Permalink to this headline">¶</a></h1>
<a class="reference internal image-reference" href="../../_images/entry152.png"><img alt="../../_images/entry152.png" src="../../_images/entry152.png" style="width: 800px;" /></a>
<div class="section" id="authors">
<h2>Authors<a class="headerlink" href="#authors" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Anna Bilous</p></li>
</ul>
<p><strong>Average and single­pulse emission of PSR B1744–24A</strong></p>
<p>Pulsars are one of the most exotic type of stars ever to be
identified: they are born in supernova explosions, when a dying star
leaves behind its rapidly spinning core, compressed to super-nuclear
densities. Astonishingly small by astronomical scales (10-20 km),
pulsars harbour ultra-strong magnetic fields and most of the time the
only way to see them is to catch the narrow beam of electromagnetic
radiation created by relativistic plasma in the pulsar’s
magnetosphere. When this beam sweeps past the Earth, like the light
from a lighthouse, a pulse is detected. The thorough investigation of
these pulses provides a wealth of astrophysical information and can
even be used to test fundamental physical theories.</p>
<p>PSR B1744–24A (also known as Ter5A) was the first pulsar discovered in
globular cluster Terzan 5, a gravitationally bound agglomeration of
stars that orbits Galactic core as a satellite. Similarly to many
other pulsars, Ter5A at most times is too faint to be detected via
individual pulses.  However, the periodicity in incoming signal can be
assessed by indirect methods and once the spin period of a pulsar is
identified, so­called “average pulse” can be accumulated by folding
the data stream synchronously with the spin period.  The case of Ter5A
is further complicated by the fact that the pulsar belongs to a tight
binary system and the appearance of the average pulse is sometimes
affected by the propagation through the cloud of plasma which
surrounds the pulsar’s companion. The center part of the plot shows
the evolution of the average pulse at radio wavelengths throughout one
orbit.  At the orbital phases 0.0 – 0.1 and 0.9 – 1.0 the pulsar is
eclipsed by its companion and close to eclipses the propagation
through the outer layers of companion star smears and delays observed
pulses.</p>
<p>Ter5A emission poses few questions which still await their
answers. One of them is the behaviour of linear polarization. In the
middle of orbital period, where pulsar is in front of the companion
and the pulsar radiation travels uninterrupted, the pulsar radio
emission has moderate, but distinct level of linear polarization (see
the inset on the right side with average pulses from selected orbital
phases). Interestingly enough, this linearly polarized emission
vanished in the vicinity of eclipses, but well before the shape of
profile or level of circular polarization changes.  Even more
puzzling, there have been spotted bursts of strong pulses (shown on
the left) which frame the disappearance of linear polarization.  These
pulses are so strong that we can detect them in original data, without
any averaging.  However, the fraction of such super-pulses is tiny and
they do not influence the average intensity or pulse shape. It is
currently unclear what makes these pulses so bright and how they are
connected to the disappearance of the linear polarization in the
average emission.  We hope that investigating this will shed some
light on the interaction of pulsar emission with companion’s plasma
and the conditions in the binary system.</p>
</div>
<div class="section" id="products">
<h2>Products<a class="headerlink" href="#products" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../../_downloads/0059c317446630dfcf8874488eb5c8e0/Ter5A.pdf"><code class="xref download docutils literal notranslate"><span class="pre">PDF</span></code></a></p></li>
</ul>
</div>
<div class="section" id="source">
<h2>Source<a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.lines</span> <span class="k">as</span> <span class="nn">mlines</span>
<span class="kn">import</span> <span class="nn">skew_projection</span>


<span class="c1">#==========================</span>
<span class="c1"># Loading data</span>
<span class="c1">#==========================</span>

<span class="n">AP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;Average_emission.npy&quot;</span><span class="p">)</span>

<span class="n">I_AP</span> <span class="o">=</span> <span class="n">AP</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>  <span class="c1"># Total intensity</span>
<span class="n">L_AP</span> <span class="o">=</span> <span class="n">AP</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>  <span class="c1"># Linearly polarized emission	</span>
<span class="n">V_AP</span> <span class="o">=</span> <span class="n">AP</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>  <span class="c1"># Circularly polarized emission</span>
<span class="n">ph_spin_AP</span> <span class="o">=</span> <span class="n">AP</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span> <span class="c1"># Spin phase of each emission sample</span>
<span class="n">ph_orb_AP</span> <span class="o">=</span> <span class="n">AP</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Orbital phase of each emission sample</span>

<span class="c1"># Loading orbital phase, spin phase and energy of single pulses</span>
<span class="n">ph_orb_SP</span><span class="p">,</span> <span class="n">ph_spin_SP</span><span class="p">,</span> <span class="n">E_SP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;Single_pulses.txt&quot;</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="n">Nsub</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">AP</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">])</span>

<span class="c1"># Offset between side plots</span>
<span class="n">dph</span> <span class="o">=</span> <span class="mf">0.35</span>

<span class="c1"># Average emission data have been normed in such way that the offpulse mean == 0 and std == 1. Rescale is needed to </span>
<span class="c1">#fit profiles in the image.</span>
<span class="n">rescale</span><span class="o">=</span><span class="mi">600</span>

<span class="c1">#===========================</span>
<span class="c1"># Plotting</span>
<span class="c1">#==========================-</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">title</span><span class="o">=</span><span class="s1">&#39;Average and single-pulse emission of PSR B1744$-$24A&#39;</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;skewx&#39;</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="s1">&#39;0.98&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nsub</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ph_spin_AP</span><span class="p">,</span> <span class="n">I_AP</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span><span class="o">/</span><span class="n">rescale</span><span class="o">+</span><span class="n">ph_orb_AP</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="s1">&#39;0.3&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> 
  <span class="n">bright</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">V_AP</span><span class="p">[</span><span class="n">k</span><span class="p">,:])</span><span class="o">&gt;</span><span class="mf">2.</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">ph_spin_AP</span><span class="p">,</span> <span class="n">V_AP</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span><span class="o">/</span><span class="n">rescale</span><span class="o">+</span><span class="n">ph_orb_AP</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ph_orb_AP</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">where</span><span class="o">=</span><span class="n">bright</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">interpolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
  <span class="n">bright</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">L_AP</span><span class="p">[</span><span class="n">k</span><span class="p">,:])</span><span class="o">&gt;</span><span class="mf">2.</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">ph_spin_AP</span><span class="p">,</span> <span class="n">L_AP</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span><span class="o">/</span><span class="n">rescale</span><span class="o">+</span><span class="n">ph_orb_AP</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ph_orb_AP</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">where</span><span class="o">=</span><span class="n">bright</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">interpolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">Nsub</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ph_spin_AP</span><span class="o">+</span><span class="n">dph</span><span class="p">,</span> <span class="n">I_AP</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span><span class="o">/</span><span class="n">rescale</span><span class="o">+</span><span class="n">ph_orb_AP</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="s1">&#39;0.3&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> 
  <span class="n">bright</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">V_AP</span><span class="p">[</span><span class="n">k</span><span class="p">,:])</span><span class="o">&gt;</span><span class="mf">2.</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">ph_spin_AP</span><span class="o">+</span><span class="n">dph</span><span class="p">,</span> <span class="n">V_AP</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span><span class="o">/</span><span class="n">rescale</span><span class="o">+</span><span class="n">ph_orb_AP</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ph_orb_AP</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">where</span><span class="o">=</span><span class="n">bright</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">interpolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
  <span class="n">bright</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">L_AP</span><span class="p">[</span><span class="n">k</span><span class="p">,:])</span><span class="o">&gt;</span><span class="mf">2.</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">ph_spin_AP</span><span class="o">+</span><span class="n">dph</span><span class="p">,</span> <span class="n">L_AP</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span><span class="o">/</span><span class="n">rescale</span><span class="o">+</span><span class="n">ph_orb_AP</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ph_orb_AP</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">where</span><span class="o">=</span><span class="n">bright</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">interpolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">sps</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">ph_spin_SP</span><span class="o">-</span><span class="n">dph</span><span class="p">,</span> <span class="n">ph_orb_SP</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">E_SP</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>


<span class="c1"># Making legend</span>
<span class="n">L_legend</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Linear&#39;</span><span class="p">)</span>
<span class="n">V_legend</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Circular&#39;</span><span class="p">)</span>
<span class="n">I_legend</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],[],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.3&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">I_legend</span><span class="p">,</span> <span class="n">L_legend</span><span class="p">,</span> <span class="n">V_legend</span><span class="p">,</span> <span class="n">sps</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Total intensity&#39;</span><span class="p">,</span> <span class="s1">&#39;Linear polarization&#39;</span><span class="p">,</span> <span class="s1">&#39;Circular polarization&#39;</span><span class="p">,</span> <span class="s1">&#39;Bright single pulses&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">9</span><span class="p">})</span>

<span class="c1"># Organizing ticks and labels</span>

<span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="o">-</span><span class="n">dph</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">-</span><span class="n">dph</span><span class="p">,</span> <span class="mf">0.2</span><span class="o">-</span><span class="n">dph</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="o">+</span><span class="n">dph</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">+</span><span class="n">dph</span><span class="p">,</span> <span class="mf">0.2</span><span class="o">+</span><span class="n">dph</span><span class="p">])</span>
<span class="n">xtick_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.05&#39;</span><span class="p">,</span> <span class="s1">&#39;0.1&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.1&#39;</span><span class="p">,</span> <span class="s1">&#39;0.2&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.1&#39;</span><span class="p">,</span> <span class="s1">&#39;0.2&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">,</span> <span class="n">xtick_labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">1.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Pulsar spin phase&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Orbital phase&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;Ter5A.pdf&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This serves as an intensive exercise of matplotlib&#39;s transforms</span>
<span class="c1"># and custom projection API. This example produces a so-called</span>
<span class="c1"># SkewT-logP diagram, which is a common plot in meteorology for</span>
<span class="c1"># displaying vertical profiles of temperature. As far as matplotlib is</span>
<span class="c1"># concerned, the complexity comes from having X and Y axes that are</span>
<span class="c1"># not orthogonal. This is handled by including a skew component to the</span>
<span class="c1"># basic Axes transforms. Additional complexity comes in handling the</span>
<span class="c1"># fact that the upper and lower X-axes have different data ranges, which</span>
<span class="c1"># necessitates a bunch of custom classes for ticks,spines, and the axis</span>
<span class="c1"># to handle this.</span>

<span class="kn">from</span> <span class="nn">matplotlib.axes</span> <span class="kn">import</span> <span class="n">Axes</span>
<span class="kn">import</span> <span class="nn">matplotlib.transforms</span> <span class="k">as</span> <span class="nn">transforms</span>
<span class="kn">import</span> <span class="nn">matplotlib.axis</span> <span class="k">as</span> <span class="nn">maxis</span>
<span class="kn">import</span> <span class="nn">matplotlib.spines</span> <span class="k">as</span> <span class="nn">mspines</span>
<span class="kn">import</span> <span class="nn">matplotlib.path</span> <span class="k">as</span> <span class="nn">mpath</span>
<span class="kn">from</span> <span class="nn">matplotlib.projections</span> <span class="kn">import</span> <span class="n">register_projection</span>

<span class="c1"># The sole purpose of this class is to look at the upper, lower, or total</span>
<span class="c1"># interval as appropriate and see what parts of the tick to draw, if any.</span>
<span class="k">class</span> <span class="nc">SkewXTick</span><span class="p">(</span><span class="n">maxis</span><span class="o">.</span><span class="n">XTick</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span> <span class="k">return</span>
        <span class="n">renderer</span><span class="o">.</span><span class="n">open_group</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="n">lower_interval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">lower_interval</span>
        <span class="n">upper_interval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">upper_interval</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gridOn</span> <span class="ow">and</span> <span class="n">transforms</span><span class="o">.</span><span class="n">interval_contains</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_view_interval</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_loc</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gridline</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">transforms</span><span class="o">.</span><span class="n">interval_contains</span><span class="p">(</span><span class="n">lower_interval</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_loc</span><span class="p">()):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tick1On</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tick1line</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label1On</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label1</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">transforms</span><span class="o">.</span><span class="n">interval_contains</span><span class="p">(</span><span class="n">upper_interval</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_loc</span><span class="p">()):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tick2On</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tick2line</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label2On</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">label2</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

        <span class="n">renderer</span><span class="o">.</span><span class="n">close_group</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>


<span class="c1"># This class exists to provide two separate sets of intervals to the tick,</span>
<span class="c1"># as well as create instances of the custom tick</span>
<span class="k">class</span> <span class="nc">SkewXAxis</span><span class="p">(</span><span class="n">maxis</span><span class="o">.</span><span class="n">XAxis</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">maxis</span><span class="o">.</span><span class="n">XAxis</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upper_interval</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span>

    <span class="k">def</span> <span class="nf">_get_tick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">major</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">SkewXTick</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">major</span><span class="o">=</span><span class="n">major</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lower_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">viewLim</span><span class="o">.</span><span class="n">intervalx</span>

    <span class="k">def</span> <span class="nf">get_view_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">viewLim</span><span class="o">.</span><span class="n">intervalx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>


<span class="c1"># This class exists to calculate the separate data range of the</span>
<span class="c1"># upper X-axis and draw the spine there. It also provides this range</span>
<span class="c1"># to the X-axis artist for ticking and gridlines</span>
<span class="k">class</span> <span class="nc">SkewSpine</span><span class="p">(</span><span class="n">mspines</span><span class="o">.</span><span class="n">Spine</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_adjust_location</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">trans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transDataToAxes</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spine_type</span> <span class="o">==</span> <span class="s1">&#39;top&#39;</span><span class="p">:</span>
            <span class="n">yloc</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">yloc</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">left</span> <span class="o">=</span> <span class="n">trans</span><span class="o">.</span><span class="n">transform_point</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">yloc</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">trans</span><span class="o">.</span><span class="n">transform_point</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">yloc</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">pts</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">vertices</span>
        <span class="n">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">left</span>
        <span class="n">pts</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">right</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">upper_interval</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>


<span class="c1"># This class handles registration of the skew-xaxes as a projection as well</span>
<span class="c1"># as setting up the appropriate transformations. It also overrides standard</span>
<span class="c1"># spines and axes instances as appropriate.</span>
<span class="k">class</span> <span class="nc">SkewXAxes</span><span class="p">(</span><span class="n">Axes</span><span class="p">):</span>
    <span class="c1"># The projection must specify a name.  This will be used be the</span>
    <span class="c1"># user to select the projection, i.e. ``subplot(111,</span>
    <span class="c1"># projection=&#39;skewx&#39;)``.</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;skewx&#39;</span>

    <span class="k">def</span> <span class="nf">_init_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#Taken from Axes and modified to use our modified X-axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span> <span class="o">=</span> <span class="n">SkewXAxis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">register_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">register_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yaxis</span> <span class="o">=</span> <span class="n">maxis</span><span class="o">.</span><span class="n">YAxis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">register_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yaxis</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">register_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yaxis</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_gen_axes_spines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">spines</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;top&#39;</span><span class="p">:</span><span class="n">SkewSpine</span><span class="o">.</span><span class="n">linear_spine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">),</span>
                  <span class="s1">&#39;bottom&#39;</span><span class="p">:</span><span class="n">mspines</span><span class="o">.</span><span class="n">Spine</span><span class="o">.</span><span class="n">linear_spine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">),</span>
                  <span class="s1">&#39;left&#39;</span><span class="p">:</span><span class="n">mspines</span><span class="o">.</span><span class="n">Spine</span><span class="o">.</span><span class="n">linear_spine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">),</span>
                  <span class="s1">&#39;right&#39;</span><span class="p">:</span><span class="n">mspines</span><span class="o">.</span><span class="n">Spine</span><span class="o">.</span><span class="n">linear_spine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">)}</span>
        <span class="k">return</span> <span class="n">spines</span>

    <span class="k">def</span> <span class="nf">_set_lim_and_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is called once when the plot is created to set up all the</span>
<span class="sd">        transforms for the data, text and grids.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rot</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>

        <span class="c1">#Get the standard transform setup from the Axes base class</span>
        <span class="n">Axes</span><span class="o">.</span><span class="n">_set_lim_and_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Need to put the skew in the middle, after the scale and limits,</span>
        <span class="c1"># but before the transAxes. This way, the skew is done in Axes</span>
        <span class="c1"># coordinates thus performing the transform around the proper origin</span>
        <span class="c1"># We keep the pre-transAxes transform around for other users, like the</span>
        <span class="c1"># spines for finding bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transDataToAxes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transScale</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transLimits</span> <span class="o">+</span>
                <span class="n">transforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">skew_deg</span><span class="p">(</span><span class="n">rot</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="c1"># Create the full transform from Data to Pixels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transDataToAxes</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">transAxes</span>

        <span class="c1"># Blended transforms like this need to have the skewing applied using</span>
        <span class="c1"># both axes, in axes coords like before.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xaxis_transform</span> <span class="o">=</span> <span class="p">(</span><span class="n">transforms</span><span class="o">.</span><span class="n">blended_transform_factory</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">transScale</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">transLimits</span><span class="p">,</span>
                    <span class="n">transforms</span><span class="o">.</span><span class="n">IdentityTransform</span><span class="p">())</span> <span class="o">+</span>
                <span class="n">transforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">skew_deg</span><span class="p">(</span><span class="n">rot</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">transAxes</span>

<span class="c1"># Now register the projection with matplotlib so the user can select</span>
<span class="c1"># it.</span>
<span class="n">register_projection</span><span class="p">(</span><span class="n">SkewXAxes</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../../_downloads/49bed869b71f913f75a7cf9f7a0d5290/Single_pulses.txt"><code class="xref download docutils literal notranslate"><span class="pre">Single_pulses.txt</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../../_downloads/15ab62a189b212e394ae73b8c6b168cb/Average_emission.npy"><code class="xref download docutils literal notranslate"><span class="pre">Average_emission.npy</span></code></a></p></li>
</ul>
</div>
</div>


  
    </div>
  
<footer class="footer">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015, Scipy Conference, designed by Nelle Varoquaux.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.2.1.<br/>
    </p>
</footer>
  </body>
</html>